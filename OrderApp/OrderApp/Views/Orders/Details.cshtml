@model OrderApp.Models.Order
<h2>Detalle Pedido #@Model.Id</h2>
<p><b>Cliente:</b> @Model.User?.Name</p>
<p><b>Estado:</b> @Model.Status</p>
<p><b>Total:</b> @Model.Total</p>

<h4>Productos</h4>
<table class="table">
    <tr><th>Producto</th><th>Cantidad</th><th>Precio</th></tr>
    @foreach (var i in Model.Items)
    {
        <tr>
            <td>@i.Product?.Name</td>
            <td>@i.Quantity</td>
            <td>@i.UnitPrice</td>
        </tr>
    }
</table>
@{
    bool canManage = User.IsInRole("Admin") || User.IsInRole("Empleado");
}
@if (canManage)
{
    <form asp-action="ChangeStatus" method="post" class="mt-3">
        @Html.AntiForgeryToken()
        <input type="hidden" name="id" value="@Model.Id" />
        <div class="input-group" style="max-width:420px;">
            <select name="status" class="form-select">
                <option value="Pending" selected="@("Pending" == Model.Status)">Pendiente</option>
                <option value="Processed" selected="@("Processed" == Model.Status)">Procesado</option>
                <option value="Shipped" selected="@("Shipped" == Model.Status)">Enviado</option>
                <option value="Delivered" selected="@("Delivered" == Model.Status)">Entregado</option>
            </select>
            <button type="submit" class="btn btn-warning">Cambiar estado</button>
        </div>
    </form>
}

